%% power quality
clc
clear all
close all
%%
y=[0	28.48038792
1	28.49488521
2	28.53889229
3	28.6132166
4	28.71871784
5	28.85631096
6	29.02697212
7	29.23174358
8	29.47174215
9	29.74810233
10	30.06232572
11	30.41568927
12	30.80970608
13	31.24601888
14	31.72641691
15	32.25285652
16	32.82748457
17	33.45266769
18	34.13102683
19	34.86548153
20	35.65930428
21	36.51618603
22	37.44032091
23	38.43651879
24	39.51034716
25	40.66832252
26	41.91817409
27	43.26920097
28	44.73278967
29	46.32317645
30	48.05859869
31	49.96312485
32	52.07306593
];
figure1 = figure;
g=[0 .5 0];
% Create axes
axes1 = axes('Parent',figure1,...
    'Position',[0.11 0.13 3.4/4 3.4/6], 'Units','inches')

hold(axes1,'on');

set(axes1,'FontName','Times New Roman','FontSize',12,'FontWeight','bold',...
    'GridAlpha',1,'GridColor',...
    [0.941176470588235 0.941176470588235 0.941176470588235],'XGrid','on','GridLineStyle',...
    '-','YGrid','on');
set(0,'DefaultAxesLineWidth',2,'DefaultLineLineWidth',1)

box(axes1,'on');
plot(y(:,1),y(:,2),'LineWidth',1,'Parent',axes1,'LineWidth',2,'Color','b')
grid on
title('Total Loss as a Function of Load Imbalance')
xlabel('intensity factor(%)')
ylabel('loss(MW)')
saveas(figure1,'totalloss.emf')
%%
figure
M=[0	0	0.02	0.04	0.06	0.08	0.1	0.12	0.14	0.16	0.18	0.2	0.22	0.24	0.26	0.28
0	28.48038954	28.56829333	28.5217308	28.33969366	28.24350815	28.76590929	28.4522986	28.28739296	28.54137924	28.44725157	28.45422546	28.46965238	28.29942371	28.15001326	28.10927915
1	28.49488665	28.44696852	28.48218855	28.61290598	28.2130324	28.56368686	28.60203113	28.83449898	28.04156104	28.42923367	27.79347341	28.47892023	28.77140677	28.97565303	28.85658523
2	28.53889361	28.5505052	28.63240742	28.48541108	28.44658864	28.42187127	28.36783376	28.88000054	28.52953933	28.70579069	29.08314791	28.0721443	28.12416897	28.24030012	29.25473028
3	28.6132184	28.61242728	28.66136767	28.71279849	28.4865041	28.44563292	28.36334416	28.42764644	28.22740582	28.47071716	27.80676793	28.78567041	28.16247787	29.03373663	28.73881672
4	28.71871929	28.71178814	28.74310454	28.77815629	28.68882871	28.30477866	28.5503652	29.13955142	28.93769278	29.32480547	28.76936697	29.13012097	28.80132829	29.38377408	28.92712892
5	28.8563126	28.83791042	28.96601493	29.09373708	29.10025718	28.86108471	28.88351191	29.23125175	28.82792113	29.36294512	28.80490102	28.96061304	28.88220839	29.00786828	29.13262985
6	29.02697359	29.00872085	29.02665759	29.05272584	29.01244642	28.78458656	29.29766514	29.06023774	28.98274845	29.20050579	29.50307062	29.63742371	29.54570975	28.94405711	29.80626143
7	29.23174492	29.17556783	29.31147493	29.2883733	29.58008088	29.01966787	29.11415142	28.75469776	29.43212237	28.82047022	29.11753746	29.66717817	29.69696883	28.65765253	29.14878577
8	29.47174405	29.52442301	29.39483284	29.55733952	29.57558966	29.4399078	29.42871824	29.63737349	29.73768444	29.78838297	29.63963948	29.35783002	30.71729019	29.19975702	29.0908235
9	29.74810412	29.7072414	29.73782019	29.56690907	29.89226046	29.96869951	29.67648133	29.81576725	29.96334316	30.011289	29.41564493	30.14565279	29.69769221	30.47618314	29.53577437
10	30.06232719	30.03339229	30.09875152	29.88549162	29.92741716	30.09623379	30.69022158	30.10399969	30.0013661	29.73107238	29.66799584	30.20060704	29.64594051	29.96796251	31.06727256
11	30.41569043	30.33703583	30.51216856	30.56848802	30.35569103	29.97020373	30.30532893	30.36686396	29.98906326	30.34388548	30.67131129	30.97102169	31.2096372	29.76165743	30.63650767
12	30.80970768	30.76521118	30.84873502	30.89241111	30.74593062	30.85655772	30.75367757	30.80521511	31.09212786	30.55596592	30.76082406	30.54467623	31.02955563	30.69973107	30.29643344
13	31.24602002	31.23583192	31.13964362	31.3577011	31.11260164	31.42669011	31.41547725	30.99272542	30.60985048	31.52953171	31.53486441	31.46137311	30.7756894	31.96725806	32.58171103
14	31.72641846	31.76178371	31.68811841	31.7231252	31.53600413	31.62614339	32.22665291	30.99353737	31.28415628	32.32452937	32.25513027	32.33677707	30.79985114	31.73287866	30.52291095
15	32.25285843	32.24729259	32.26909544	32.2994178	32.40887627	31.73713413	32.21118605	32.19813692	32.14896121	31.75925712	32.51731543	30.90837732	32.53606737	32.91014943	32.46798604
16	32.82748659	32.85510475	32.84928837	33.26808377	32.63385576	33.13219682	33.49790621	32.66212895	32.72935731	33.38660195	32.41044415	32.13742535	32.48970826	32.61970195	33.07655121
17	33.4526693	33.46847437	33.45835656	33.74477377	33.2555191	33.83144626	33.80381411	33.18042665	33.41731562	34.09555154	33.7625833	33.19965911	32.71071748	32.78904146	33.37897236
18	34.13102764	34.05605823	34.13764111	34.43073243	33.80225644	34.42670564	34.24724179	33.72983227	34.56181796	33.89813697	33.22424141	34.50222448	34.81455472	34.43004547	35.5661783
19	34.86548277	34.81298843	35.02421287	34.48804511	34.91118448	34.8579806	34.9895583	34.92052596	35.52369263	35.29435279	33.74083336	35.5687365	36.58054895	35.87693916	37.04915555
20	35.65930564	35.61395223	35.69515843	35.48547616	36.17730855	35.71203798	35.47144243	36.13856438	36.29149452	35.639186	35.49638969	35.43952056	35.23448297	36.17510366	36.95391287
21	36.51618678	36.51109969	36.50911953	36.23578145	37.10084749	36.45203766	35.57479194	35.98333238	37.6935081	36.09079002	35.30402479	37.46418984	36.60057793	36.6386192	36.57838613
22	37.44032177	37.40206003	37.48749257	37.57209784	37.54144742	37.9017226	37.00035308	37.13102808	38.33938871	36.37731806	38.25674884	36.467083	39.57362924	36.58434576	37.52094397
23	38.43651928	38.3972451	38.22572338	38.40727931	38.61692086	38.34694911	39.03441312	38.66914715	37.88410876	38.89709831	38.45187048	40.03533896	38.85149196	37.57908596	38.1895488
24	39.51034768	39.53253505	39.43629627	38.98266167	38.9928866	39.71812001	40.24949543	38.82277283	39.6394985	38.9862812	38.75993504	38.61352427	39.44451942	40.15868755	39.13204414
25	40.66832402	40.70266266	40.79061163	40.90940362	40.15748379	40.58453117	41.05498777	40.68448382	40.11670058	40.7504207	39.87536517	41.92532383	40.89060344	40.91640198	40.5399782
26	41.91817505	41.88434593	41.75661021	41.62029864	41.3366817	42.85913794	41.82197177	41.44316513	42.20708866	40.52626243	42.78990581	38.83177337	42.54188165	43.98386897	41.83470104
27	43.26920146	43.22088718	43.40424475	43.38516145	42.87077924	43.6386616	43.39528065	43.79808855	43.4652724	44.78071574	42.82624195	42.89025229	43.02403061	43.95249248	44.75043306
28	44.73279088	44.81932793	44.96507727	44.63706853	44.33910283	44.63711892	44.93578073	44.15467376	43.96448516	45.12373773	45.3314394	44.33305599	42.25151208	42.26580006	45.25888165
29	46.32317776	46.35202789	46.13926631	46.91830838	46.61542561	46.02696215	47.21518709	46.66117741	46.75981008	46.04962812	46.95795193	46.1052318	44.47554775	45.099452	45.62284806
30	48.0585992	48.11635446	47.79435108	48.13341361	47.74882831	48.06543575	48.60552958	48.57265981	48.01262651	47.24795724	47.82650117	48.66922103	47.22782487	50.20520911	48.29908873
31	49.96312563	49.92466565	49.52108839	50.3865027	49.90670506	51.23279199	50.82086562	50.7884826	48.76098043	47.92563746	50.81618163	49.74652628	49.140609	49.95353791	51.17202172
32	52.07306606	52.08356024	51.72631756	51.51560187	52.21944201	52.17783801	51.80689139	52.03907411	52.46285037	53.21535604	53.17824983	53.90156057	54.09711559	52.90014921	51.00607926
];
z=M(2:end,2:end);
x=M(1,2:end);
y=M(2:end,1);
meshgrid(x,y);
surf(x,y,z)
title('comparison of total loss')
xlabel('variance')
ylabel('intensity factor')
zlabel('loss(MW)')
saveas(figure1,'totalloss3.emf')
%% 
% y=[0	28.48272888
% 0.01	28.49245251
% 0.02	28.50225503
% 0.03	28.51215849
% 0.04	28.52218228
% 0.05	28.53235717
% 0.06	28.54270772
% 0.07	28.55326127
% 0.08	28.56401796
% 0.09	28.57498167
% 0.1	28.58619406
% ];
% plot(y(:,1),y(:,2))
% grid on
% title('total loss of MV system')
% xlabel('intensity factor of PF(%)')
% ylabel('loss(MW)')
